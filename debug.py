import librosa
import numpy as np
import matplotlib.pyplot as plt
# --- Configuration ---
CONFIG = {
    "sample_rate": 16000,    # Hz
    "window_duration": 1.5,  # seconds (length of one spectrogram)
    "hop_duration": 0.5,     # seconds (how much to slide the window)
    "n_mels": 64,            # Number of Mel bands (reduced for ESP32 efficiency)
    "n_fft": 1024,           # Number of FFT points
    "max_spectrogram_width": 48 # Fixed width for spectrograms (time steps)
}


# --- Paste C++ Spectrogram Data Here ---
cpp_spectrogram_str = """-80.0000,-80.0000,-80.0000,-80.0000,-77.8774,-70.8826,-60.7866,-40.9300,-6.2226,-0.2262,-13.2549,-48.6958,-64.0508,-72.6882,-78.8941,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,\n-80.0000,-80.0000,-80.0000,-80.0000,-79.1592,-73.4357,-66.0436,-54.9970,-30.7936,-2.7567,-1.5498,-23.5055,-52.3995,-64.4833,-72.1311,-77.8665,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,\n-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-77.1859,-71.2312,-63.2354,-50.4476,-20.2181,-0.7345,-4.1921,-33.6826,-56.2938,-66.7312,-73.7761,-79.2199,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,\n-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-77.6540,-71.1858,-62.1868,-46.0152,-10.0271,0.0000,-8.6714,-43.1363,-61.4803,-71.0030,-77.7072,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,\n-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-73.6705,-62.3334,-38.9211,-4.8890,-0.5289,-15.9586,-52.1563,-68.8185,-78.5089,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,\n-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-73.4971,-58.6227,-27.4075,-1.9850,-2.2289,-27.6533,-58.9390,-73.3169,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,\n-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-74.3532,-65.5514,-50.4277,-15.7125,-0.3751,-5.3611,-38.4695,-60.1549,-70.4663,-77.4213,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,\n-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-75.7302,-69.1532,-59.8305,-42.2842,-7.9515,-0.0617,-10.5062,-45.2666,-61.0209,-69.8218,-76.1578,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,\n-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-78.8026,-73.4089,-66.3477,-55.9164,-33.6416,-3.8047,-0.9248,-19.9203,-50.5158,-63.3713,-71.3481,-77.2816,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,\n-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-79.0265,-73.2108,-65.4456,-53.0405,-23.3880,-1.3400,-3.0513,-30.7476,-56.2212,-67.5298,-74.9929,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,\n-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-75.7419,-66.4438,-49.5550,-12.3880,-0.1627,-6.6912,-41.6987,-63.4229,-74.4828,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,\n-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-77.9732,-65.2526,-41.5051,-6.4166,-0.1875,-13.0785,-50.9217,-69.4999,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,\n-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-77.6484,-69.8209,-57.6454,-30.0196,-2.8704,-1.4607,-24.5750,-55.0732,-68.1058,-76.3937,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,\n-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-78.1279,-72.1041,-63.9812,-50.6338,-18.8105,-0.8375,-4.0105,-35.0434,-57.1136,-67.8825,-75.4016,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,\n-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-75.5584,-69.1791,-60.3080,-44.2840,-10.1105,-0.0377,-8.3886,-43.0582,-60.3031,-70.0134,-77.3774,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,\n-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-75.1689,-68.2680,-58.1684,-37.0362,-5.1229,-0.4647,-17.0938,-50.6801,-65.4087,-74.7245,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,\n-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-77.4227,-69.5583,-56.8410,-26.7712,-2.0386,-2.4239,-29.3549,-59.6103,-73.6865,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,\n-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-70.7130,-52.5440,-14.8065,-0.4968,-6.1890,-43.1254,-69.6167,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,\n-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-73.8275,-63.5523,-42.9867,-6.8815,-0.5495,-14.0533,-54.9700,-70.4242,-79.8858,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,\n-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-74.8571,-67.6512,-56.7012,-31.0351,-2.6592,-2.6221,-32.7315,-59.3238,-71.4314,-79.5007,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,\n-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-77.5531,-71.7578,-63.9148,-50.7428,-18.5934,-0.5567,-7.8552,-45.5991,-64.4966,-74.4962,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,\n-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-76.9384,-70.6750,-61.5797,-44.4784,-5.7829,-1.2329,-20.0258,-57.0062,-70.7908,-79.5348,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,\n-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-78.8836,-71.6086,-60.2342,-26.6899,-1.8875,-4.5798,-42.7742,-67.7752,-79.4398,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,\n-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-73.5935,-52.8187,-9.9937,-0.7880,-14.4019,-60.2316,-79.7906,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,\n-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-76.7173,-64.6380,-34.5028,-3.1788,-3.3398,-39.8007,-67.8473,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,\n-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-76.8307,-68.4690,-54.1580,-14.9246,-0.9141,-11.0950,-54.6335,-70.7225,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,\n-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-78.8933,-72.2035,-62.5790,-40.6179,-4.1968,-2.8718,-35.0581,-62.8749,-75.0192,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,\n-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-77.0219,-69.4971,-56.7044,-17.0706,-1.2891,-9.5109,-53.3926,-70.9889,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,\n-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-77.4478,-67.8175,-44.6571,-4.7481,-2.8552,-32.9241,-67.4957,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,\n-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-63.6629,-16.9857,-1.5461,-9.4654,-59.4437,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,\n-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-71.9049,-45.5443,-4.7692,-3.1799,-36.0052,-71.1372,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,\n-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-73.3552,-59.4948,-18.2802,-1.5082,-11.2728,-58.1014,-74.7946,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,\n-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-75.8870,-65.9486,-44.5869,-4.3561,-3.8519,-39.4710,-67.6053,-79.1943,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,\n-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-79.8092,-71.8633,-58.4653,-13.1550,-1.7338,-13.7002,-60.2822,-75.7194,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,\n-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-78.9644,-68.7424,-41.0057,-3.6984,-4.9592,-47.2976,-73.5594,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,\n-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-61.5332,-9.7764,-2.1153,-19.6726,-70.8144,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,\n-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-71.8612,-32.7069,-2.9591,-6.7903,-57.0598,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,\n-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-73.5465,-54.5880,-6.8996,-3.0384,-31.5166,-69.9873,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,\n-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-75.8411,-63.3863,-22.5139,-2.2862,-10.3803,-60.3313,-76.5649,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,\n-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-77.1906,-65.4986,-26.7407,-2.5012,-9.1373,-60.1711,-78.1366,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,\n-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-71.5066,-54.7571,-7.7726,-2.7491,-27.2677,-67.0301,-79.8870,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,\n-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-77.4450,-66.4305,-35.7073,-3.2985,-6.0927,-51.7770,-73.2163,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,\n-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-76.3677,-60.3868,-11.2744,-1.9854,-16.7964,-65.7229,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,\n-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-75.8202,-44.7087,-4.1519,-4.4421,-45.8592,-78.5621,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,\n-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-78.7801,-64.3957,-15.6018,-1.7573,-11.8685,-63.3744,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,\n-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-78.0541,-68.4196,-48.2094,-4.9445,-3.4095,-35.9995,-68.7591,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,\n-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-79.4120,-71.8629,-59.1951,-22.3543,-1.6955,-9.5372,-55.1496,-72.5680,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,\n-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-76.1150,-66.7489,-46.3107,-5.4880,-2.7662,-31.7739,-64.7824,-77.1948,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,-80.0000,\n"""

# --- Parse and Reshape ---
cpp_spectrogram_flat = np.fromstring(cpp_spectrogram_str.replace('\n', ''), sep=',')
# CRITICAL FIX: C++ now outputs in row-major order (frequency x time)
cpp_spectrogram = cpp_spectrogram_flat.reshape(CONFIG['max_spectrogram_width'], CONFIG['n_mels']).T

print("C++ spectrogram shape:", cpp_spectrogram.shape)


# --- Compare Spectrograms ---
fig, axs = plt.subplots(1, 1, figsize=(10, 8))

# C++ Spectrogram
img2 = librosa.display.specshow(cpp_spectrogram, sr=CONFIG['sample_rate'], x_axis='time', y_axis='mel', ax=axs)
fig.colorbar(img2, ax=axs, format='%+2.0f dB')
axs.set_title('C++ Mel Spectrogram')

plt.tight_layout()

plt.savefig('debug.png')
plt.show()
